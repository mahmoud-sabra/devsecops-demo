{"version":"1.136.0","results":[{"check_id":"dockerfile.security.missing-user.missing-user","path":"Dockerfile","start":{"line":26,"col":1,"offset":495},"end":{"line":26,"col":15,"offset":509},"extra":{"metavars":{"$...VARS":{"start":{"line":26,"col":5,"offset":499},"end":{"line":26,"col":15,"offset":509},"abstract_content":"[\"app.js\"]"}},"message":"By not specifying a USER, a program in the container may run as 'root'. This is a security hazard. If an attacker can control a process running as root, they may have control over the container. Ensure that the last USER in a Dockerfile is a USER other than 'root'.","fix":"USER non-root\nCMD [\"app.js\"]","metadata":{"cwe":["CWE-250: Execution with Unnecessary Privileges"],"category":"security","technology":["dockerfile"],"confidence":"MEDIUM","owasp":["A04:2021 - Insecure Design"],"references":["https://owasp.org/Top10/A04_2021-Insecure_Design"],"subcategory":["audit"],"likelihood":"LOW","impact":"MEDIUM","license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Improper Authorization"],"source":"https://semgrep.dev/r/dockerfile.security.missing-user.missing-user","shortlink":"https://sg.run/Gbvn","semgrep.dev":{"rule":{"origin":"community","r_id":20148,"rule_id":"AbUN06","rule_name":"dockerfile.security.missing-user.missing-user","rv_id":1032972,"url":"https://semgrep.dev/playground/r/5PTA4lQ/dockerfile.security.missing-user.missing-user","version_id":"5PTA4lQ"},"src":"unchanged"},"dev.semgrep.actions":["block"],"semgrep.policy":{"id":217943,"name":"Rule Board - Block column","slug":"rule-board-block"},"semgrep.url":"https://semgrep.dev/r/dockerfile.security.missing-user.missing-user","semgrep.ruleset":"default","semgrep.ruleset_id":3471},"severity":"ERROR","fingerprint":"f623f9d29235f450be86e78fa2fc446ce2f22a2602f42c98c937d4fddfe4f50bc8e5e1daab6f307af3888e1b0b149665f6afdc04235449b46c1d5198ca4a9b2d_0","lines":"CMD [\"app.js\"]","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"PRO"}},{"check_id":"javascript.express.security.audit.express-check-csurf-middleware-usage.express-check-csurf-middleware-usage","path":"app.js","start":{"line":3,"col":7,"offset":52},"end":{"line":3,"col":22,"offset":67},"extra":{"metavars":{"$APP":{"start":{"line":3,"col":7,"offset":52},"end":{"line":3,"col":10,"offset":55},"abstract_content":"app"},"$EXPRESS":{"start":{"line":3,"col":13,"offset":58},"end":{"line":3,"col":20,"offset":65},"abstract_content":"express"}},"message":"A CSRF middleware was not detected in your express application. Ensure you are either using one such as `csurf` or `csrf` (see rule references) and/or you are properly doing CSRF validation in your routes with a token or cookies.","metadata":{"category":"security","references":["https://www.npmjs.com/package/csurf","https://www.npmjs.com/package/csrf","https://cheatsheetseries.owasp.org/cheatsheets/Cross-Site_Request_Forgery_Prevention_Cheat_Sheet.html"],"cwe":["CWE-352: Cross-Site Request Forgery (CSRF)"],"owasp":["A01:2021 - Broken Access Control"],"technology":["javascript","typescript","express"],"cwe2022-top25":true,"cwe2021-top25":true,"subcategory":["audit"],"likelihood":"LOW","impact":"HIGH","confidence":"LOW","license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Cross-Site Request Forgery (CSRF)"],"source":"https://semgrep.dev/r/javascript.express.security.audit.express-check-csurf-middleware-usage.express-check-csurf-middleware-usage","shortlink":"https://sg.run/BxzR","semgrep.dev":{"rule":{"origin":"community","r_id":22551,"rule_id":"wdUKEq","rule_name":"javascript.express.security.audit.express-check-csurf-middleware-usage.express-check-csurf-middleware-usage","rv_id":945789,"url":"https://semgrep.dev/playground/r/NdTqkvB/javascript.express.security.audit.express-check-csurf-middleware-usage.express-check-csurf-middleware-usage","version_id":"NdTqkvB"},"src":"unchanged"},"dev.semgrep.actions":["block"],"semgrep.policy":{"id":217943,"name":"Rule Board - Block column","slug":"rule-board-block"},"semgrep.url":"https://semgrep.dev/r/javascript.express.security.audit.express-check-csurf-middleware-usage.express-check-csurf-middleware-usage","semgrep.ruleset":"default","semgrep.ruleset_id":3471},"severity":"INFO","fingerprint":"0ca2ac6b959f7c5907d739b98e5b297c8c2abb85c1aa4bb6d35f9009eedb0bce0fbdc8deef3d6adc336f5ebe0a5ff3152dc52621edc463f7501b3e44c6db188e_0","lines":"const app = express();","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"PRO"}},{"check_id":"ssc-ca33ac32-d4dd-4e81-9601-743f7de420bb","path":"app.js","start":{"line":9,"col":9,"offset":227},"end":{"line":9,"col":51,"offset":269},"extra":{"metavars":{"$1":{"start":{"line":1,"col":1,"offset":0},"end":{"line":1,"col":12,"offset":11},"abstract_content":"body-parser"},"$PACKAGE":{"start":{"line":4,"col":29,"offset":97},"end":{"line":4,"col":40,"offset":108},"abstract_content":"body-parser"},"$IMPORT":{"start":{"line":9,"col":9,"offset":227},"end":{"line":9,"col":19,"offset":237},"abstract_content":"bodyParser","propagated_value":{"svalue_start":{"line":4,"col":20,"offset":88},"svalue_end":{"line":4,"col":42,"offset":110},"svalue_abstract_content":"require('body-parser')"}},"$FUNCLASS":{"start":{"line":9,"col":20,"offset":238},"end":{"line":9,"col":30,"offset":248},"abstract_content":"urlencoded"}},"message":"Affected versions of body-parser are vulnerable to Asymmetric Resource Consumption (Amplification).","metadata":{"confidence":"HIGH","category":"security","cve":"CVE-2024-45590","cwe":["CWE-405: Asymmetric Resource Consumption (Amplification)"],"ghsa":"GHSA-qwcr-r2fm-qrc7","owasp":["A06:2021 - Vulnerable and Outdated Components"],"publish-date":"2024-09-10T15:52:39Z","references":["https://github.com/advisories/GHSA-qwcr-r2fm-qrc7","https://nvd.nist.gov/vuln/detail/CVE-2024-45590"],"sca-fix-versions":[{"body-parser":"1.20.3"}],"sca-kind":"reachable","sca-schema":20230302,"sca-severity":"HIGH","sca-vuln-database-identifier":"CVE-2024-45590","technology":["js","ts"],"license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Other"],"semgrep.dev":{"rule":{"origin":"custom","r_id":142955,"rule_id":"gxU3j79","rule_name":"ssc-ca33ac32-d4dd-4e81-9601-743f7de420bb","rv_id":1129916,"url":"https://semgrep.dev/orgs/-/supply-chain/advisories?q=ssc-ca33ac32-d4dd-4e81-9601-743f7de420bb","version_id":"O9TdXqP"},"src":"unchanged"},"source":"https://semgrep.dev/orgs/-/supply-chain/advisories?q=ssc-ca33ac32-d4dd-4e81-9601-743f7de420bb","semgrep.url":"https://semgrep.dev/orgs/-/supply-chain/advisories?q=ssc-ca33ac32-d4dd-4e81-9601-743f7de420bb","dev.semgrep.actions":[]},"severity":"ERROR","fingerprint":"7bf406d8f628e8a0132bffbbbfdb1f12224ca2f7f93a78da2c1359d6d45e4bf42c21fa4386bf46b0fb422b57115f3ff63ebe593f0b75fa534b75f981a3c6d782_0","lines":"app.use(bodyParser.urlencoded({ extended: false }));","is_ignored":false,"sca_info":{"reachability_rule":true,"sca_finding_schema":20220913,"dependency_match":{"dependency_pattern":{"ecosystem":"npm","package":"body-parser","semver_range":"<1.20.3"},"found_dependency":{"package":"body-parser","version":"1.19.0","ecosystem":"npm","allowed_hashes":{"sha512":["76110fb3bd943db0e701027d64a30d4cfea9b496a2a2784fe5c05be78d675cf956eb425ea68f5157f6b87d7e17596f42b8534adb692b86b8f5fab83389f342b3"]},"resolved_url":"https://registry.npmjs.org/body-parser/-/body-parser-1.19.0.tgz","transitivity":"direct","manifest_path":"package.json","lockfile_path":"package-lock.json","line_number":324},"lockfile":"package-lock.json"},"reachable":true},"validation_state":"NO_VALIDATOR","engine_kind":"PRO"}},{"check_id":"javascript.mysql.node-mysql-hardcoded-secret.node-mysql-hardcoded-secret","path":"app.js","start":{"line":16,"col":35,"offset":488},"end":{"line":21,"col":2,"offset":609},"extra":{"metavars":{"$1":{"start":{"line":1,"col":1,"offset":0},"end":{"line":1,"col":6,"offset":5},"abstract_content":"mysql"},"$IMPORT":{"start":{"line":5,"col":24,"offset":135},"end":{"line":5,"col":29,"offset":140},"abstract_content":"mysql"},"$MYSQL":{"start":{"line":16,"col":12,"offset":465},"end":{"line":16,"col":17,"offset":470},"abstract_content":"mysql"},"$FOO":{"start":{"line":16,"col":35,"offset":488},"end":{"line":21,"col":2,"offset":609},"abstract_content":"{host'localhost'user'root'password'password'database'demo'}"}},"message":"A secret is hard-coded in the application. Secrets stored in source code, such as credentials, identifiers, and other types of sensitive data, can be leaked and used by internal or external malicious actors. Use environment variables to securely provide credentials and other secrets or retrieve them from a secure vault or Hardware Security Module (HSM).","metadata":{"likelihood":"HIGH","impact":"MEDIUM","confidence":"HIGH","interfile":true,"category":"security","subcategory":["vuln"],"cwe":["CWE-798: Use of Hard-coded Credentials"],"cwe2021-top25":true,"cwe2022-top25":true,"owasp":["A07:2021 - Identification and Authentication Failures"],"references":["https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"],"technology":["mysql","sql","mysql2","nodejs","secrets"],"license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Hard-coded Secrets"],"source":"https://semgrep.dev/r/javascript.mysql.node-mysql-hardcoded-secret.node-mysql-hardcoded-secret","shortlink":"https://sg.run/GJ36","semgrep.dev":{"rule":{"origin":"pro_rules","r_id":28092,"rule_id":"6JU2k0","rule_name":"javascript.mysql.node-mysql-hardcoded-secret.node-mysql-hardcoded-secret","rv_id":947639,"url":"https://semgrep.dev/playground/r/6xTxqAx/javascript.mysql.node-mysql-hardcoded-secret.node-mysql-hardcoded-secret","version_id":"6xTxqAx"},"src":"unchanged"},"dev.semgrep.actions":["block"],"semgrep.policy":{"id":217943,"name":"Rule Board - Block column","slug":"rule-board-block"},"semgrep.url":"https://semgrep.dev/r/javascript.mysql.node-mysql-hardcoded-secret.node-mysql-hardcoded-secret","semgrep.ruleset":"default","semgrep.ruleset_id":3471},"severity":"WARNING","fingerprint":"072543f9ef3b1f890af511883f4a9c220e4dee9e3cf24a6230432ddf1985bba8898d1b7f19fa4236f106837a2564b8e765e559c45208acab97e6c8b5c3617167_0","lines":"const db = mysql.createConnection({\n    host: 'localhost',\n    user: 'root',\n    password: 'password', // 🚨 Hardcoded DB password\n    database: 'demo'\n});","is_ignored":false,"validation_state":"NO_VALIDATOR","dataflow_trace":{"taint_source":["CliLoc",[{"path":"app.js","start":{"line":16,"col":35,"offset":488},"end":{"line":21,"col":2,"offset":609}},"{\n    host: 'localhost',\n    user: 'root',\n    password: 'password', // 🚨 Hardcoded DB password\n    database: 'demo'\n}"]],"intermediate_vars":[],"taint_sink":["CliLoc",[{"path":"app.js","start":{"line":16,"col":35,"offset":488},"end":{"line":21,"col":2,"offset":609}},"{\n    host: 'localhost',\n    user: 'root',\n    password: 'password', // 🚨 Hardcoded DB password\n    database: 'demo'\n}"]]},"engine_kind":"PRO"}},{"check_id":"javascript.express.db.mysql-express.mysql-express","path":"app.js","start":{"line":42,"col":5,"offset":1354},"end":{"line":42,"col":7,"offset":1356},"extra":{"metavars":{"$MYSQL":{"start":{"line":16,"col":12,"offset":465},"end":{"line":16,"col":17,"offset":470},"abstract_content":"mysql"},"$REQ":{"start":{"line":39,"col":22,"offset":1230},"end":{"line":39,"col":25,"offset":1233},"abstract_content":"req"},"$SINK":{"start":{"line":40,"col":19,"offset":1268},"end":{"line":40,"col":70,"offset":1319},"abstract_content":"`SELECT * FROM users WHERE username = 'username'"},"$DB":{"start":{"line":42,"col":5,"offset":1354},"end":{"line":42,"col":7,"offset":1356},"abstract_content":"db","propagated_value":{"svalue_start":{"line":16,"col":12,"offset":465},"svalue_end":{"line":21,"col":3,"offset":610},"svalue_abstract_content":"mysql.createConnection({host'localhost'user'root'password'password'database'demo'})"}}},"message":"Untrusted input might be used to build a database query, which can lead to a SQL injection vulnerability. An attacker can execute malicious SQL statements and gain unauthorized access to sensitive data, modify, delete data, or execute arbitrary system commands. To prevent this vulnerability, use prepared statements that do not concatenate user-controllable strings and use parameterized queries where SQL commands and user data are strictly separated. Also, consider using an object-relational (ORM) framework to operate with safer abstractions.","metadata":{"likelihood":"HIGH","impact":"HIGH","confidence":"HIGH","category":"security","subcategory":["vuln"],"cwe":["CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"],"cwe2020-top25":true,"cwe2021-top25":true,"cwe2022-top25":true,"display-name":"SQL Injection in MySQL with Express","functional-categories":["db::sink::query::mysql","db::sink::query::mysql2","web::source::cookie::express","web::source::form-data::express","web::source::header::express","web::source::http-body::express","web::source::url-path-params::express","web::source::url-query-string::express"],"owasp":["A01:2017 - Injection","A03:2021 - Injection"],"references":["https://github.com/mysqljs/mysql?tab=readme-ov-file#escaping-query-values","https://owasp.org/Top10/A03_2021-Injection"],"supersedes":["javascript.express.mysql.express-mysql-sqli.express-mysql-sqli"],"technology":["db","express","mysql","mysql2","mysql2/promise","web"],"license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["SQL Injection"],"source":"https://semgrep.dev/r/javascript.express.db.mysql-express.mysql-express","shortlink":"https://sg.run/5r7Al","semgrep.dev":{"rule":{"origin":"pro_rules","r_id":147647,"rule_id":"3qUkyOG","rule_name":"javascript.express.db.mysql-express.mysql-express","rv_id":1041961,"url":"https://semgrep.dev/playground/r/5PTANp6/javascript.express.db.mysql-express.mysql-express","version_id":"5PTANp6"},"src":"unchanged"},"dev.semgrep.actions":["block"],"semgrep.policy":{"id":217943,"name":"Rule Board - Block column","slug":"rule-board-block"},"semgrep.url":"https://semgrep.dev/r/javascript.express.db.mysql-express.mysql-express","semgrep.ruleset":"default","semgrep.ruleset_id":3471},"severity":"CRITICAL","fingerprint":"4840c555f4fd777d76bb39883c49b2c549fa0f60a7abb8eacbe880b55c17e92b1f078af579b6cf17363acaa8736347cd4fa8a5946f67f53f23b9778d19c7a580_0","lines":"    db.query(query, (err, result) => {","is_ignored":false,"validation_state":"NO_VALIDATOR","dataflow_trace":{"taint_source":["CliLoc",[{"path":"app.js","start":{"line":39,"col":22,"offset":1230},"end":{"line":39,"col":25,"offset":1233}},"req"]],"intermediate_vars":[{"location":{"path":"app.js","start":{"line":39,"col":11,"offset":1219},"end":{"line":39,"col":19,"offset":1227}},"content":"username"},{"location":{"path":"app.js","start":{"line":40,"col":19,"offset":1268},"end":{"line":40,"col":20,"offset":1269}},"content":"`"},{"location":{"path":"app.js","start":{"line":40,"col":11,"offset":1260},"end":{"line":40,"col":16,"offset":1265}},"content":"query"}],"taint_sink":["CliLoc",[{"path":"app.js","start":{"line":42,"col":5,"offset":1354},"end":{"line":42,"col":7,"offset":1356}},"db"]]},"engine_kind":"PRO"}},{"check_id":"javascript.express.mysql.express-mysql-sqli.express-mysql-sqli","path":"app.js","start":{"line":42,"col":5,"offset":1354},"end":{"line":48,"col":7,"offset":1579},"extra":{"metavars":{"$1":{"start":{"line":1,"col":1,"offset":0},"end":{"line":1,"col":6,"offset":5},"abstract_content":"query"},"$IMPORT":{"start":{"line":5,"col":24,"offset":135},"end":{"line":5,"col":29,"offset":140},"abstract_content":"mysql"},"$MYSQL":{"start":{"line":16,"col":12,"offset":465},"end":{"line":16,"col":17,"offset":470},"abstract_content":"mysql"},"$APP":{"start":{"line":38,"col":1,"offset":1176},"end":{"line":38,"col":4,"offset":1179},"abstract_content":"app","propagated_value":{"svalue_start":{"line":3,"col":13,"offset":58},"svalue_end":{"line":3,"col":22,"offset":67},"svalue_abstract_content":"express()"}},"$METHOD":{"start":{"line":38,"col":5,"offset":1180},"end":{"line":38,"col":8,"offset":1183},"abstract_content":"get"},"$RES":{"start":{"line":38,"col":24,"offset":1199},"end":{"line":38,"col":27,"offset":1202},"abstract_content":"res"},"$REQ":{"start":{"line":39,"col":22,"offset":1230},"end":{"line":39,"col":25,"offset":1233},"abstract_content":"req"},"$X":{"start":{"line":42,"col":5,"offset":1354},"end":{"line":42,"col":7,"offset":1356},"abstract_content":"db","propagated_value":{"svalue_start":{"line":16,"col":12,"offset":465},"svalue_end":{"line":21,"col":3,"offset":610},"svalue_abstract_content":"mysql.createConnection({host'localhost'user'root'password'password'database'demo'})"}},"$QUERY":{"start":{"line":42,"col":8,"offset":1357},"end":{"line":42,"col":13,"offset":1362},"abstract_content":"query"}},"message":"Untrusted input might be used to build a database query, which can lead to a SQL injection vulnerability. An attacker can execute malicious SQL statements and gain unauthorized access to sensitive data, modify, delete data, or execute arbitrary system commands. To prevent this vulnerability, use prepared statements that do not concatenate user-controllable strings and use parameterized queries where SQL commands and user data are strictly separated. Also, consider using an object-relational (ORM) framework to operate with safer abstractions.","metadata":{"likelihood":"HIGH","impact":"HIGH","confidence":"HIGH","interfile":true,"category":"security","subcategory":["vuln"],"cwe":["CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"],"cwe2021-top25":true,"cwe2022-top25":true,"functional-categories":["web::source::cookie::express","web::source::http-params::express","web::source::http-body::express","web::source::header::express","web::source::url-path-params::express","db::sink::sql-or-nosql-query::mysql","db::sink::sql-or-nosql-query::mysql2"],"owasp":["A01:2017 - Injection","A03:2021 - Injection"],"references":["https://sequelize.org/docs/v6/core-concepts/raw-queries/#replacements"],"technology":["express"],"license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["SQL Injection"],"source":"https://semgrep.dev/r/javascript.express.mysql.express-mysql-sqli.express-mysql-sqli","shortlink":"https://sg.run/306W","semgrep.dev":{"rule":{"origin":"pro_rules","r_id":28087,"rule_id":"0oUKZo","rule_name":"javascript.express.mysql.express-mysql-sqli.express-mysql-sqli","rv_id":1014901,"url":"https://semgrep.dev/playground/r/K3TJprl/javascript.express.mysql.express-mysql-sqli.express-mysql-sqli","version_id":"K3TJprl"},"src":"unchanged"},"dev.semgrep.actions":["block"],"semgrep.policy":{"id":217943,"name":"Rule Board - Block column","slug":"rule-board-block"},"semgrep.url":"https://semgrep.dev/r/javascript.express.mysql.express-mysql-sqli.express-mysql-sqli","semgrep.ruleset":"default","semgrep.ruleset_id":3471},"severity":"CRITICAL","fingerprint":"a8392f6a6c56b2b68e388e61852c899bcaaffcfe724b91aa09a7d680071e6cc0e9346fcfc94915f170eb0ca5e2c7845ce5af6978909c02aaf3c6a23df48d2746_0","lines":"    db.query(query, (err, result) => {\n        if (err) {\n            res.status(500).send(`<pre>SQL Error: ${err.message}</pre>`);\n        } else {\n            res.send(result.length ? result : 'No user found');\n        }\n    });","is_ignored":false,"validation_state":"NO_VALIDATOR","dataflow_trace":{"taint_source":["CliLoc",[{"path":"app.js","start":{"line":39,"col":22,"offset":1230},"end":{"line":39,"col":31,"offset":1239}},"req.query"]],"intermediate_vars":[{"location":{"path":"app.js","start":{"line":39,"col":11,"offset":1219},"end":{"line":39,"col":19,"offset":1227}},"content":"username"},{"location":{"path":"app.js","start":{"line":40,"col":19,"offset":1268},"end":{"line":40,"col":20,"offset":1269}},"content":"`"},{"location":{"path":"app.js","start":{"line":40,"col":11,"offset":1260},"end":{"line":40,"col":16,"offset":1265}},"content":"query"}],"taint_sink":["CliLoc",[{"path":"app.js","start":{"line":42,"col":5,"offset":1354},"end":{"line":48,"col":7,"offset":1579}},"db.query(query, (err, result) => {\n        if (err) {\n            res.status(500).send(`<pre>SQL Error: ${err.message}</pre>`);\n        } else {\n            res.send(result.length ? result : 'No user found');\n        }\n    })"]]},"engine_kind":"PRO"}},{"check_id":"javascript.express.security.audit.xss.direct-response-write.direct-response-write","path":"app.js","start":{"line":54,"col":14,"offset":1703},"end":{"line":54,"col":37,"offset":1726},"extra":{"metavars":{"$1":{"start":{"line":1,"col":1,"offset":0},"end":{"line":1,"col":4,"offset":3},"abstract_content":"get"},"$APP":{"start":{"line":52,"col":1,"offset":1612},"end":{"line":52,"col":4,"offset":1615},"abstract_content":"app","propagated_value":{"svalue_start":{"line":3,"col":13,"offset":58},"svalue_end":{"line":3,"col":22,"offset":67},"svalue_abstract_content":"express()"}},"$METHOD":{"start":{"line":52,"col":5,"offset":1616},"end":{"line":52,"col":8,"offset":1619},"abstract_content":"get"},"$RES":{"start":{"line":52,"col":25,"offset":1636},"end":{"line":52,"col":28,"offset":1639},"abstract_content":"res"},"$REQ":{"start":{"line":53,"col":18,"offset":1663},"end":{"line":53,"col":21,"offset":1666},"abstract_content":"req"},"$ARG":{"start":{"line":54,"col":14,"offset":1703},"end":{"line":54,"col":37,"offset":1726},"abstract_content":"`<h1>Hello name</h1>"}},"message":"Detected directly writing to a Response object from user-defined input. This bypasses any HTML escaping and may expose your application to a Cross-Site-scripting (XSS) vulnerability. Instead, use 'resp.render()' to render safely escaped HTML.","metadata":{"interfile":true,"references":["https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html"],"owasp":["A07:2017 - Cross-Site Scripting (XSS)","A03:2021 - Injection"],"cwe":["CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"],"category":"security","technology":["express"],"cwe2022-top25":true,"cwe2021-top25":true,"subcategory":["vuln"],"likelihood":"MEDIUM","impact":"MEDIUM","confidence":"MEDIUM","vulnerability_class":["Cross-Site-Scripting (XSS)"],"license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","source":"https://semgrep.dev/r/javascript.express.security.audit.xss.direct-response-write.direct-response-write","shortlink":"https://sg.run/vzGl","semgrep.dev":{"rule":{"origin":"community","r_id":9277,"rule_id":"3qUPA1","rule_name":"javascript.express.security.audit.xss.direct-response-write.direct-response-write","rv_id":945811,"url":"https://semgrep.dev/playground/r/RGTAgNy/javascript.express.security.audit.xss.direct-response-write.direct-response-write","version_id":"RGTAgNy"},"src":"unchanged"},"dev.semgrep.actions":["block"],"semgrep.policy":{"id":217943,"name":"Rule Board - Block column","slug":"rule-board-block"},"semgrep.url":"https://semgrep.dev/r/javascript.express.security.audit.xss.direct-response-write.direct-response-write","semgrep.ruleset":"default","semgrep.ruleset_id":3471},"severity":"WARNING","fingerprint":"d934c51c974946233e9dbbf2a421894adce9b4e974d0c5deb1513c8a5fb28160318c74b084550d86bae735aefb773258d4168f6ad268c7f9e2140b8c47f06252_0","lines":"    res.send(`<h1>Hello ${name}</h1>`); // 🚨 Vulnerable to XSS","is_ignored":false,"validation_state":"NO_VALIDATOR","dataflow_trace":{"taint_source":["CliLoc",[{"path":"app.js","start":{"line":53,"col":18,"offset":1663},"end":{"line":53,"col":27,"offset":1672}},"req.query"]],"intermediate_vars":[{"location":{"path":"app.js","start":{"line":53,"col":11,"offset":1656},"end":{"line":53,"col":15,"offset":1660}},"content":"name"}],"taint_sink":["CliLoc",[{"path":"app.js","start":{"line":54,"col":14,"offset":1703},"end":{"line":54,"col":37,"offset":1726}},"`<h1>Hello ${name}</h1>"]]},"engine_kind":"PRO"}},{"check_id":"javascript.express.security.injection.raw-html-format.raw-html-format","path":"app.js","start":{"line":54,"col":14,"offset":1703},"end":{"line":54,"col":37,"offset":1726},"extra":{"metavars":{"$1":{"start":{"line":1,"col":1,"offset":0},"end":{"line":1,"col":4,"offset":3},"abstract_content":"get"},"$APP":{"start":{"line":52,"col":1,"offset":1612},"end":{"line":52,"col":4,"offset":1615},"abstract_content":"app","propagated_value":{"svalue_start":{"line":3,"col":13,"offset":58},"svalue_end":{"line":3,"col":22,"offset":67},"svalue_abstract_content":"express()"}},"$METHOD":{"start":{"line":52,"col":5,"offset":1616},"end":{"line":52,"col":8,"offset":1619},"abstract_content":"get"},"$RES":{"start":{"line":52,"col":25,"offset":1636},"end":{"line":52,"col":28,"offset":1639},"abstract_content":"res"},"$REQ":{"start":{"line":53,"col":18,"offset":1663},"end":{"line":53,"col":21,"offset":1666},"abstract_content":"req"}},"message":"User data flows into the host portion of this manually-constructed HTML. This can introduce a Cross-Site-Scripting (XSS) vulnerability if this comes from user-provided input. Consider using a sanitization library such as DOMPurify to sanitize the HTML within.","metadata":{"cwe":["CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"],"owasp":["A07:2017 - Cross-Site Scripting (XSS)","A03:2021 - Injection"],"references":["https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html"],"category":"security","technology":["express"],"cwe2022-top25":true,"cwe2021-top25":true,"subcategory":["vuln"],"likelihood":"HIGH","impact":"MEDIUM","confidence":"MEDIUM","license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Cross-Site-Scripting (XSS)"],"source":"https://semgrep.dev/r/javascript.express.security.injection.raw-html-format.raw-html-format","shortlink":"https://sg.run/5DO3","semgrep.dev":{"rule":{"origin":"community","r_id":14691,"rule_id":"5rUL0X","rule_name":"javascript.express.security.injection.raw-html-format.raw-html-format","rv_id":945836,"url":"https://semgrep.dev/playground/r/xyTqnbZ/javascript.express.security.injection.raw-html-format.raw-html-format","version_id":"xyTqnbZ"},"src":"unchanged"},"dev.semgrep.actions":["block"],"semgrep.policy":{"id":217943,"name":"Rule Board - Block column","slug":"rule-board-block"},"semgrep.url":"https://semgrep.dev/r/javascript.express.security.injection.raw-html-format.raw-html-format","semgrep.ruleset":"default","semgrep.ruleset_id":3471},"severity":"WARNING","fingerprint":"da5702cc1971e306e49635287a94cb8ff5f333dae1e6df114f6ff17df5bdefdee9e39709cb364efb203adcf1c017a073ba6b64599056e7650adfb180cfcc2a40_0","lines":"    res.send(`<h1>Hello ${name}</h1>`); // 🚨 Vulnerable to XSS","is_ignored":false,"validation_state":"NO_VALIDATOR","dataflow_trace":{"taint_source":["CliLoc",[{"path":"app.js","start":{"line":53,"col":18,"offset":1663},"end":{"line":53,"col":27,"offset":1672}},"req.query"]],"intermediate_vars":[{"location":{"path":"app.js","start":{"line":53,"col":11,"offset":1656},"end":{"line":53,"col":15,"offset":1660}},"content":"name"}],"taint_sink":["CliLoc",[{"path":"app.js","start":{"line":54,"col":14,"offset":1703},"end":{"line":54,"col":37,"offset":1726}},"`<h1>Hello ${name}</h1>"]]},"engine_kind":"PRO"}},{"check_id":"javascript.express.express-child-process.express-child-process","path":"app.js","start":{"line":60,"col":24,"offset":1907},"end":{"line":60,"col":27,"offset":1910},"extra":{"metavars":{"$1":{"start":{"line":1,"col":1,"offset":0},"end":{"line":1,"col":5,"offset":4},"abstract_content":"exec"},"$REQ":{"start":{"line":59,"col":17,"offset":1839},"end":{"line":59,"col":20,"offset":1842},"abstract_content":"req"},"$CP":{"start":{"line":60,"col":5,"offset":1888},"end":{"line":60,"col":18,"offset":1901},"abstract_content":"child_process","propagated_value":{"svalue_start":{"line":7,"col":23,"offset":192},"svalue_end":{"line":7,"col":47,"offset":216},"svalue_abstract_content":"require('child_process')"}},"$EXEC":{"start":{"line":60,"col":19,"offset":1902},"end":{"line":60,"col":23,"offset":1906},"abstract_content":"exec"},"$CMD":{"start":{"line":60,"col":24,"offset":1907},"end":{"line":60,"col":27,"offset":1910},"abstract_content":"cmd","propagated_value":{"svalue_start":{"line":59,"col":17,"offset":1839},"svalue_end":{"line":59,"col":30,"offset":1852},"svalue_abstract_content":"req.query.cmd"}}},"message":"Untrusted input might be injected into a command executed by the application, which can lead to a command injection vulnerability. An attacker can execute arbitrary commands, potentially gaining complete control of the system. To prevent this vulnerability, avoid executing OS commands with user input. If this is unavoidable, validate and sanitize the user input, and use safe methods for executing the commands. For more information, see [Command injection prevention for JavaScript ](https://semgrep.dev/docs/cheat-sheets/javascript-command-injection/).","metadata":{"likelihood":"HIGH","impact":"HIGH","confidence":"MEDIUM","interfile":true,"category":"security","subcategory":["vuln"],"cwe":["CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')"],"cwe2021-top25":true,"cwe2022-top25":true,"functional-categories":["web::source::cookie::express","web::source::http-params::express","web::source::http-body::express","web::source::header::express","web::source::url-path-params::express","os::sink::os-command-or-thread:nodejs.child_process"],"owasp":["A01:2017 - Injection","A03:2021 - Injection"],"references":["https://cheatsheetseries.owasp.org/cheatsheets/Nodejs_Security_Cheat_Sheet.html#do-not-use-dangerous-functions"],"source-rule-url":"https://github.com/nodesecurity/eslint-plugin-security/blob/master/rules/detect-child-process.js","technology":["javascript","express","nodejs"],"license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Command Injection"],"source":"https://semgrep.dev/r/javascript.express.express-child-process.express-child-process","shortlink":"https://sg.run/9p1R","semgrep.dev":{"rule":{"origin":"pro_rules","r_id":28867,"rule_id":"L1Uk12","rule_name":"javascript.express.express-child-process.express-child-process","rv_id":1014898,"url":"https://semgrep.dev/playground/r/DkTNOG5/javascript.express.express-child-process.express-child-process","version_id":"DkTNOG5"},"src":"unchanged"},"dev.semgrep.actions":["block"],"semgrep.policy":{"id":217943,"name":"Rule Board - Block column","slug":"rule-board-block"},"semgrep.url":"https://semgrep.dev/r/javascript.express.express-child-process.express-child-process","semgrep.ruleset":"default","semgrep.ruleset_id":3471},"severity":"CRITICAL","fingerprint":"e274c793110681fb3dae94a8817570cbbac69cc8ec2c7c1c09f04d9c77ddac8ce7e14b15a63dd12c4fb759660857cf1cf6a5803e35bd1247b096d85d2ac6bd4e_0","lines":"    child_process.exec(cmd, (err, stdout, stderr) => {","is_ignored":false,"validation_state":"NO_VALIDATOR","dataflow_trace":{"taint_source":["CliLoc",[{"path":"app.js","start":{"line":59,"col":17,"offset":1839},"end":{"line":59,"col":26,"offset":1848}},"req.query"]],"intermediate_vars":[{"location":{"path":"app.js","start":{"line":59,"col":11,"offset":1833},"end":{"line":59,"col":14,"offset":1836}},"content":"cmd"}],"taint_sink":["CliLoc",[{"path":"app.js","start":{"line":60,"col":24,"offset":1907},"end":{"line":60,"col":27,"offset":1910}},"cmd"]]},"engine_kind":"PRO"}},{"check_id":"javascript.express.os.tainted-os-command-child-process-express.tainted-os-command-child-process-express","path":"app.js","start":{"line":60,"col":24,"offset":1907},"end":{"line":60,"col":27,"offset":1910},"extra":{"metavars":{"$REQ":{"start":{"line":59,"col":17,"offset":1839},"end":{"line":59,"col":20,"offset":1842},"abstract_content":"req"},"$CHILD_PROCESS":{"start":{"line":60,"col":5,"offset":1888},"end":{"line":60,"col":18,"offset":1901},"abstract_content":"child_process","propagated_value":{"svalue_start":{"line":7,"col":23,"offset":192},"svalue_end":{"line":7,"col":47,"offset":216},"svalue_abstract_content":"require('child_process')"}},"$SINK":{"start":{"line":60,"col":24,"offset":1907},"end":{"line":60,"col":27,"offset":1910},"abstract_content":"cmd","propagated_value":{"svalue_start":{"line":59,"col":17,"offset":1839},"svalue_end":{"line":59,"col":30,"offset":1852},"svalue_abstract_content":"req.query.cmd"}}},"message":"Untrusted input might be injected into a command executed by the application, which can lead to a command injection vulnerability. An attacker can execute arbitrary commands, potentially gaining complete control of the system. To prevent this vulnerability, avoid executing OS commands with user input. If this is unavoidable, validate and sanitize the input, and use safe methods for executing the commands. For more information, see: [JavaScript command injection prevention](https://semgrep.dev/docs/cheat-sheets/javascript-command-injection/)","metadata":{"likelihood":"MEDIUM","impact":"HIGH","confidence":"HIGH","category":"security","subcategory":["vuln"],"cwe":["CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')"],"cwe2020-top25":true,"cwe2021-top25":true,"cwe2022-top25":true,"display-name":"OS Command Injection in Express with Child Process","functional-categories":["os::sink::command::child-process","web::source::cookie::express","web::source::form-data::express","web::source::header::express","web::source::http-body::express","web::source::url-path-params::express","web::source::url-query-string::express"],"owasp":["A01:2017 - Injection","A03:2021 - Injection"],"references":["https://owasp.org/Top10/A03_2021-Injection"],"supersedes":["javascript.lang.security.audit.dangerous-spawn-shell","javascript.lang.security.audit.spawn-shell-true","javascript.lang.security.detect-child-process","javascript.lang.security.spawn-git-clone","javascript.lang.security.spawn-shell-true"],"technology":["express","nodejs","web"],"license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Command Injection"],"source":"https://semgrep.dev/r/javascript.express.os.tainted-os-command-child-process-express.tainted-os-command-child-process-express","shortlink":"https://sg.run/AbAz6","semgrep.dev":{"rule":{"origin":"pro_rules","r_id":147650,"rule_id":"JDUN8D0","rule_name":"javascript.express.os.tainted-os-command-child-process-express.tainted-os-command-child-process-express","rv_id":1041987,"url":"https://semgrep.dev/playground/r/w8TnkAq/javascript.express.os.tainted-os-command-child-process-express.tainted-os-command-child-process-express","version_id":"w8TnkAq"},"src":"unchanged"},"dev.semgrep.actions":["block"],"semgrep.policy":{"id":217943,"name":"Rule Board - Block column","slug":"rule-board-block"},"semgrep.url":"https://semgrep.dev/r/javascript.express.os.tainted-os-command-child-process-express.tainted-os-command-child-process-express","semgrep.ruleset":"default","semgrep.ruleset_id":3471},"severity":"ERROR","fingerprint":"72240680e19a08fe8052594d39b98f1bbbf86823cc43e3deafd2dfed64ee8f1dab760bc4ab17090ffd09cdf1d01222ed67fc018e314226f29b354885744c9cf1_0","lines":"    child_process.exec(cmd, (err, stdout, stderr) => {","is_ignored":false,"validation_state":"NO_VALIDATOR","dataflow_trace":{"taint_source":["CliLoc",[{"path":"app.js","start":{"line":59,"col":17,"offset":1839},"end":{"line":59,"col":20,"offset":1842}},"req"]],"intermediate_vars":[{"location":{"path":"app.js","start":{"line":59,"col":11,"offset":1833},"end":{"line":59,"col":14,"offset":1836}},"content":"cmd"}],"taint_sink":["CliLoc",[{"path":"app.js","start":{"line":60,"col":24,"offset":1907},"end":{"line":60,"col":27,"offset":1910}},"cmd"]]},"engine_kind":"PRO"}},{"check_id":"javascript.lang.security.detect-child-process.detect-child-process","path":"app.js","start":{"line":60,"col":24,"offset":1907},"end":{"line":60,"col":27,"offset":1910},"extra":{"metavars":{"$FUNC":{"start":{"line":58,"col":19,"offset":1808},"end":{"line":58,"col":22,"offset":1811},"abstract_content":"req"},"$CP":{"start":{"line":60,"col":5,"offset":1888},"end":{"line":60,"col":18,"offset":1901},"abstract_content":"child_process"},"$CMD":{"start":{"line":60,"col":24,"offset":1907},"end":{"line":60,"col":27,"offset":1910},"abstract_content":"cmd","propagated_value":{"svalue_start":{"line":59,"col":17,"offset":1839},"svalue_end":{"line":59,"col":30,"offset":1852},"svalue_abstract_content":"req.query.cmd"}}},"message":"Detected calls to child_process from a function argument `req`. This could lead to a command injection if the input is user controllable. Try to avoid calls to child_process, and if it is needed ensure user input is correctly sanitized or sandboxed. ","metadata":{"cwe":["CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')"],"owasp":["A01:2017 - Injection","A03:2021 - Injection"],"references":["https://cheatsheetseries.owasp.org/cheatsheets/Nodejs_Security_Cheat_Sheet.html#do-not-use-dangerous-functions"],"source-rule-url":"https://github.com/nodesecurity/eslint-plugin-security/blob/master/rules/detect-child-process.js","category":"security","technology":["javascript"],"cwe2022-top25":true,"cwe2021-top25":true,"subcategory":["audit"],"likelihood":"LOW","impact":"HIGH","confidence":"LOW","license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Command Injection"],"source":"https://semgrep.dev/r/javascript.lang.security.detect-child-process.detect-child-process","shortlink":"https://sg.run/l2lo","semgrep.dev":{"rule":{"origin":"community","r_id":9313,"rule_id":"10UKNB","rule_name":"javascript.lang.security.detect-child-process.detect-child-process","rv_id":945887,"url":"https://semgrep.dev/playground/r/yeT0n95/javascript.lang.security.detect-child-process.detect-child-process","version_id":"yeT0n95"},"src":"unchanged"},"dev.semgrep.actions":["block"],"semgrep.policy":{"id":217943,"name":"Rule Board - Block column","slug":"rule-board-block"},"semgrep.url":"https://semgrep.dev/r/javascript.lang.security.detect-child-process.detect-child-process","semgrep.ruleset":"default","semgrep.ruleset_id":3471},"severity":"ERROR","fingerprint":"de70707570e2a29651cc0b67286829b1c29e80b884777c54b4a3843521af6271f73d149bc1e4f9fa31e1cf412c6bba1e41e68589f06f71273a8bfd676d0855bc_0","lines":"    child_process.exec(cmd, (err, stdout, stderr) => {","is_ignored":false,"validation_state":"NO_VALIDATOR","dataflow_trace":{"taint_source":["CliLoc",[{"path":"app.js","start":{"line":58,"col":19,"offset":1808},"end":{"line":58,"col":22,"offset":1811}},"req"]],"intermediate_vars":[{"location":{"path":"app.js","start":{"line":58,"col":19,"offset":1808},"end":{"line":58,"col":22,"offset":1811}},"content":"req"},{"location":{"path":"app.js","start":{"line":59,"col":11,"offset":1833},"end":{"line":59,"col":14,"offset":1836}},"content":"cmd"}],"taint_sink":["CliLoc",[{"path":"app.js","start":{"line":60,"col":24,"offset":1907},"end":{"line":60,"col":27,"offset":1910}},"cmd"]]},"engine_kind":"PRO"}},{"check_id":"javascript.express.express-fs-filename.express-fs-filename","path":"app.js","start":{"line":69,"col":17,"offset":2204},"end":{"line":69,"col":25,"offset":2212},"extra":{"metavars":{"$1":{"start":{"line":1,"col":1,"offset":0},"end":{"line":1,"col":4,"offset":3},"abstract_content":"get"},"$APP":{"start":{"line":67,"col":1,"offset":2092},"end":{"line":67,"col":4,"offset":2095},"abstract_content":"app","propagated_value":{"svalue_start":{"line":3,"col":13,"offset":58},"svalue_end":{"line":3,"col":22,"offset":67},"svalue_abstract_content":"express()"}},"$METHOD":{"start":{"line":67,"col":5,"offset":2096},"end":{"line":67,"col":8,"offset":2099},"abstract_content":"get"},"$RES":{"start":{"line":67,"col":24,"offset":2115},"end":{"line":67,"col":27,"offset":2118},"abstract_content":"res"},"$REQ":{"start":{"line":68,"col":22,"offset":2146},"end":{"line":68,"col":25,"offset":2149},"abstract_content":"req"},"$FS":{"start":{"line":69,"col":5,"offset":2192},"end":{"line":69,"col":7,"offset":2194},"abstract_content":"fs","propagated_value":{"svalue_start":{"line":6,"col":12,"offset":155},"svalue_end":{"line":6,"col":25,"offset":168},"svalue_abstract_content":"require('fs')"}},"$FILE":{"start":{"line":69,"col":17,"offset":2204},"end":{"line":69,"col":25,"offset":2212},"abstract_content":"filePath","propagated_value":{"svalue_start":{"line":68,"col":22,"offset":2146},"svalue_end":{"line":68,"col":36,"offset":2160},"svalue_abstract_content":"req.query.file"}}},"message":"The application builds a file path from potentially untrusted data, which can lead to a path traversal vulnerability. An attacker can manipulate the file path which the application uses to access files. If the application does not validate user input and sanitize file paths, sensitive files such as configuration or user data can be accessed, potentially creating or overwriting files. To prevent this vulnerability, validate and sanitize any input that is used to create references to file paths. Also, enforce strict file access controls. For example, choose privileges allowing public-facing applications to access only the required files.","metadata":{"likelihood":"HIGH","impact":"MEDIUM","confidence":"MEDIUM","category":"security","subcategory":["vuln"],"cwe":["CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"],"cwe2021-top25":true,"cwe2022-top25":true,"functional-categories":["web::source::cookie::express","web::source::http-params::express","web::source::http-body::express","web::source::header::express","web::source::url-path-params::express","file::sink::file-access:nodejs.fs"],"owasp":["A05:2017 - Broken Access Control","A01:2021 - Broken Access Control"],"references":["https://owasp.org/www-community/attacks/Path_Traversal"],"technology":["express","nodejs"],"license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Path Traversal"],"source":"https://semgrep.dev/r/javascript.express.express-fs-filename.express-fs-filename","shortlink":"https://sg.run/0B9W","semgrep.dev":{"rule":{"origin":"pro_rules","r_id":28654,"rule_id":"kxUzPO","rule_name":"javascript.express.express-fs-filename.express-fs-filename","rv_id":947607,"url":"https://semgrep.dev/playground/r/NdTqAQv/javascript.express.express-fs-filename.express-fs-filename","version_id":"NdTqAQv"},"src":"unchanged"},"dev.semgrep.actions":["block"],"semgrep.policy":{"id":217943,"name":"Rule Board - Block column","slug":"rule-board-block"},"semgrep.url":"https://semgrep.dev/r/javascript.express.express-fs-filename.express-fs-filename","semgrep.ruleset":"default","semgrep.ruleset_id":3471},"severity":"WARNING","fingerprint":"991bbfbf90d236e378ba5a33af24acdc4a8b7ed55a8e202a18ff7eb721dfef8c90ff96ffe592d480be99fbe0979cef016a63ad0216005d4fe60d50034da8ddd4_0","lines":"    fs.readFile(filePath, 'utf8', (err, data) => {","is_ignored":false,"validation_state":"NO_VALIDATOR","dataflow_trace":{"taint_source":["CliLoc",[{"path":"app.js","start":{"line":68,"col":22,"offset":2146},"end":{"line":68,"col":31,"offset":2155}},"req.query"]],"intermediate_vars":[{"location":{"path":"app.js","start":{"line":68,"col":11,"offset":2135},"end":{"line":68,"col":19,"offset":2143}},"content":"filePath"}],"taint_sink":["CliLoc",[{"path":"app.js","start":{"line":69,"col":17,"offset":2204},"end":{"line":69,"col":25,"offset":2212}},"filePath"]]},"engine_kind":"PRO"}},{"check_id":"javascript.express.file.fs-express.fs-express","path":"app.js","start":{"line":69,"col":17,"offset":2204},"end":{"line":69,"col":25,"offset":2212},"extra":{"metavars":{"$1":{"start":{"line":1,"col":1,"offset":0},"end":{"line":1,"col":5,"offset":4},"abstract_content":"read"},"$REQ":{"start":{"line":68,"col":22,"offset":2146},"end":{"line":68,"col":25,"offset":2149},"abstract_content":"req"},"$PKG":{"start":{"line":69,"col":5,"offset":2192},"end":{"line":69,"col":7,"offset":2194},"abstract_content":"fs"},"$FUNC":{"start":{"line":69,"col":8,"offset":2195},"end":{"line":69,"col":16,"offset":2203},"abstract_content":"readFile"},"$SINK":{"start":{"line":69,"col":17,"offset":2204},"end":{"line":69,"col":25,"offset":2212},"abstract_content":"filePath","propagated_value":{"svalue_start":{"line":68,"col":22,"offset":2146},"svalue_end":{"line":68,"col":36,"offset":2160},"svalue_abstract_content":"req.query.file"}}},"message":"The application builds a file path from potentially untrusted data, which can lead to a path traversal vulnerability. An attacker can manipulate the path which the application uses to access files. If the application does not validate user input and sanitize file paths, sensitive files such as configuration or user data can be accessed, potentially creating or overwriting files. To prevent this vulnerability, validate and sanitize any input that is used to create references to file paths. Also, enforce strict file access controls. For example, choose privileges allowing public-facing applications to access only the required files.","metadata":{"likelihood":"MEDIUM","impact":"HIGH","confidence":"HIGH","category":"security","subcategory":["vuln"],"cwe":["CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"],"cwe2020-top25":true,"cwe2021-top25":true,"cwe2022-top25":true,"display-name":"Path Traversal in fs with Express","functional-categories":["file::sink::file-access::fs","file::sink::file-access::fs/promises","file::sink::file-access::node:fs","file::sink::file-access::node:fs/promises","web::source::cookie::express","web::source::form-data::express","web::source::header::express","web::source::http-body::express","web::source::url-path-params::express","web::source::url-query-string::express"],"owasp":["A01:2021 - Broken Access Control","A05:2017 - Broken Access Control"],"references":["https://nodejs.org/api/fs.html#promises-api","https://owasp.org/Top10/A01_2021-Broken_Access_Control","https://owasp.org/www-community/attacks/Path_Traversal","https://portswigger.net/web-security/file-path-traversal"],"technology":["express","nodejs","web"],"license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Path Traversal"],"source":"https://semgrep.dev/r/javascript.express.file.fs-express.fs-express","shortlink":"https://sg.run/GdqX1","semgrep.dev":{"rule":{"origin":"pro_rules","r_id":147648,"rule_id":"4bURrZB","rule_name":"javascript.express.file.fs-express.fs-express","rv_id":1041966,"url":"https://semgrep.dev/playground/r/DkTn2Gq/javascript.express.file.fs-express.fs-express","version_id":"DkTn2Gq"},"src":"unchanged"},"dev.semgrep.actions":["block"],"semgrep.policy":{"id":217943,"name":"Rule Board - Block column","slug":"rule-board-block"},"semgrep.url":"https://semgrep.dev/r/javascript.express.file.fs-express.fs-express","semgrep.ruleset":"default","semgrep.ruleset_id":3471},"severity":"ERROR","fingerprint":"55efc1b83fb6b30db769e4d485fc6d9793ecdf703fc2f0d7f7b080d0f6aff1bddddeab088de45588900994f87039ecdcbc109ee30ca4cc056af308ae554a62d7_0","lines":"    fs.readFile(filePath, 'utf8', (err, data) => {","is_ignored":false,"validation_state":"NO_VALIDATOR","dataflow_trace":{"taint_source":["CliLoc",[{"path":"app.js","start":{"line":68,"col":22,"offset":2146},"end":{"line":68,"col":25,"offset":2149}},"req"]],"intermediate_vars":[{"location":{"path":"app.js","start":{"line":68,"col":11,"offset":2135},"end":{"line":68,"col":19,"offset":2143}},"content":"filePath"}],"taint_sink":["CliLoc",[{"path":"app.js","start":{"line":69,"col":17,"offset":2204},"end":{"line":69,"col":25,"offset":2212}},"filePath"]]},"engine_kind":"PRO"}},{"check_id":"javascript.express.web.cookies-default-express.cookies-default-express","path":"app.js","start":{"line":77,"col":5,"offset":2420},"end":{"line":77,"col":49,"offset":2464},"extra":{"metavars":{"$REQ":{"start":{"line":76,"col":24,"offset":2401},"end":{"line":76,"col":27,"offset":2404},"abstract_content":"req"},"$RES":{"start":{"line":77,"col":5,"offset":2420},"end":{"line":77,"col":8,"offset":2423},"abstract_content":"res"},"$KEY":{"start":{"line":77,"col":16,"offset":2431},"end":{"line":77,"col":25,"offset":2440},"abstract_content":"\"session\""},"$VALUE":{"start":{"line":77,"col":27,"offset":2442},"end":{"line":77,"col":48,"offset":2463},"abstract_content":"\"admin-session-12345\""}},"message":"Having default cookie settings is insecure because they often lack critical security attributes, leaving cookies vulnerable to various attacks like CSRF or XSS. Always configure cookies with security attributes: `HttpOnly`, `Secure`, `SameSite`.","metadata":{"likelihood":"MEDIUM","impact":"MEDIUM","confidence":"HIGH","category":"security","subcategory":["secure default"],"cwe":["CWE-732: Incorrect Permission Assignment for Critical Resource"],"cwe2020-top25":true,"cwe2021-top25":true,"display-name":"Default Cookie Settings in Express","functional-categories":["web::search::cookie-config::express"],"references":["https://cwe.mitre.org/data/definitions/732.html","https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/06-Session_Management_Testing/02-Testing_for_Cookies_Attributes"],"technology":["express"],"license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Improper Authorization"],"source":"https://semgrep.dev/r/javascript.express.web.cookies-default-express.cookies-default-express","shortlink":"https://sg.run/JDG5Z","semgrep.dev":{"rule":{"origin":"pro_rules","r_id":150902,"rule_id":"WAUW4bA","rule_name":"javascript.express.web.cookies-default-express.cookies-default-express","rv_id":973749,"url":"https://semgrep.dev/playground/r/0bT1qOB/javascript.express.web.cookies-default-express.cookies-default-express","version_id":"0bT1qOB"},"src":"unchanged"},"dev.semgrep.actions":["block"],"semgrep.policy":{"id":217943,"name":"Rule Board - Block column","slug":"rule-board-block"},"semgrep.url":"https://semgrep.dev/r/javascript.express.web.cookies-default-express.cookies-default-express","semgrep.ruleset":"default","semgrep.ruleset_id":3471},"severity":"WARNING","fingerprint":"3580981d9076e9bee96ea07f5fd3107cf243b6dab9ab560f165e311deb0315dd47a61898e53802725e7d871646caf22969eb107f74094fb69162510be86bb5d5_0","lines":"    res.cookie(\"session\", \"admin-session-12345\"); // 🚨 No HttpOnly, No Secure, No SameSite","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"PRO"}},{"check_id":"ssc-parity-850b9dcb20685b9815262ddab1b91e691291c4a9","path":"package-lock.json","start":{"line":440,"col":1,"offset":0},"end":{"line":440,"col":1,"offset":0},"extra":{"metavars":{},"message":"Affected versions of cookie are vulnerable to Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection').","metadata":{"confidence":"LOW","category":"security","cve":"CVE-2024-47764","cwe":["CWE-74: Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection')"],"ghsa":"GHSA-pxg6-pf52-xh8x","owasp":["A03:2021 - Injection","A06:2021 - Vulnerable and Outdated Components"],"publish-date":"2024-10-04T20:31:00Z","references":["https://github.com/advisories/GHSA-pxg6-pf52-xh8x"],"sca-fix-versions":[{"cookie":"0.7.0"}],"sca-kind":"legacy","sca-schema":20230302,"sca-severity":"LOW","sca-vuln-database-identifier":"CVE-2024-47764","technology":["js","ts"],"license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Other"],"semgrep.dev":{"rule":{"r_id":144219,"rv_id":968415,"rule_id":"ReUDJBy","version_id":"w8TKWAy","url":"https://semgrep.dev/orgs/-/supply-chain/advisories?q=ssc-parity-850b9dcb20685b9815262ddab1b91e691291c4a9","origin":"custom","rule_name":"ssc-parity-850b9dcb20685b9815262ddab1b91e691291c4a9"},"src":"unchanged"},"source":"https://semgrep.dev/orgs/-/supply-chain/advisories?q=ssc-parity-850b9dcb20685b9815262ddab1b91e691291c4a9","semgrep.url":"https://semgrep.dev/orgs/-/supply-chain/advisories?q=ssc-parity-850b9dcb20685b9815262ddab1b91e691291c4a9","dev.semgrep.actions":[]},"severity":"WARNING","fingerprint":"3cf00b934478ca8649ffcd15614451eb0b83de2bb126c643bad77e78bc27eb3bf1ecb994e2d29e045a269738facc4beb96ebb63938c9d0b3d0b95b4401f6fe9a_0","lines":"    \"node_modules/cookie\": {","is_ignored":false,"sca_info":{"reachability_rule":false,"sca_finding_schema":20220913,"dependency_match":{"dependency_pattern":{"ecosystem":"npm","package":"cookie","semver_range":"<0.7.0"},"found_dependency":{"package":"cookie","version":"0.4.0","ecosystem":"npm","allowed_hashes":{"sha512":["f87a7c7cba79ef09d44add2d634b47117878be86510e7a08ad93ea968dc33e2238cbd97083f8eac7ed4e9bde3f5ba65a3c33946e78ceb7ff7dc3aeb393e9755e"]},"resolved_url":"https://registry.npmjs.org/cookie/-/cookie-0.4.0.tgz","transitivity":"transitive","manifest_path":"package.json","lockfile_path":"package-lock.json","line_number":440},"lockfile":"package-lock.json"},"reachable":false},"engine_kind":"OSS"}},{"check_id":"ssc-parity-2aeb3e53f53b5d0dcb698105c15abbd1768e24a4","path":"package-lock.json","start":{"line":739,"col":1,"offset":0},"end":{"line":739,"col":1,"offset":0},"extra":{"metavars":{},"message":"Affected versions of express are vulnerable to Improper Validation of Syntactic Correctness of Input / URL Redirection to Untrusted Site ('Open Redirect').","metadata":{"confidence":"LOW","category":"security","cve":"CVE-2024-29041","cwe":["CWE-1286: Improper Validation of Syntactic Correctness of Input","CWE-601: URL Redirection to Untrusted Site ('Open Redirect')"],"ghsa":"GHSA-rv95-896h-c2vc","owasp":["A01:2021 - Broken Access Control","A06:2021 - Vulnerable and Outdated Components"],"publish-date":"2024-03-25T19:40:26Z","references":["https://github.com/advisories/GHSA-rv95-896h-c2vc","https://nvd.nist.gov/vuln/detail/CVE-2024-29041"],"sca-fix-versions":[{"express":"5.0.0-beta.3"},{"express":"4.19.2"}],"sca-kind":"legacy","sca-schema":20230302,"sca-severity":"MODERATE","sca-vuln-database-identifier":"CVE-2024-29041","technology":["js","ts"],"license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Open Redirect","Other"],"semgrep.dev":{"rule":{"r_id":121897,"rv_id":970360,"rule_id":"GdUvBwY","version_id":"K3TJ8rZ","url":"https://semgrep.dev/orgs/-/supply-chain/advisories?q=ssc-parity-2aeb3e53f53b5d0dcb698105c15abbd1768e24a4","origin":"custom","rule_name":"ssc-parity-2aeb3e53f53b5d0dcb698105c15abbd1768e24a4"},"src":"unchanged"},"source":"https://semgrep.dev/orgs/-/supply-chain/advisories?q=ssc-parity-2aeb3e53f53b5d0dcb698105c15abbd1768e24a4","semgrep.url":"https://semgrep.dev/orgs/-/supply-chain/advisories?q=ssc-parity-2aeb3e53f53b5d0dcb698105c15abbd1768e24a4","dev.semgrep.actions":[]},"severity":"WARNING","fingerprint":"47ec6bff53902210c9f290616d376207125d3dbd41208adc155ed96ded5521600298af29c438056d7444a79a5524b486fcbd65f8f9f825a7c62d92fbff1d5698_0","lines":"    \"node_modules/express\": {","is_ignored":false,"sca_info":{"reachability_rule":false,"sca_finding_schema":20220913,"dependency_match":{"dependency_pattern":{"ecosystem":"npm","package":"express","semver_range":"<4.19.2"},"found_dependency":{"package":"express","version":"4.17.1","ecosystem":"npm","allowed_hashes":{"sha512":["98727d3bbf51aa5ba9851adcc365ff19387793db55bfc61ca326382a487858331460a45952ad21d68d30dabaebc41a8ced5a1e515aa06f6ef19443174e762de2"]},"resolved_url":"https://registry.npmjs.org/express/-/express-4.17.1.tgz","transitivity":"direct","manifest_path":"package.json","lockfile_path":"package-lock.json","line_number":739},"lockfile":"package-lock.json"},"reachable":false},"engine_kind":"OSS"}},{"check_id":"ssc-parity-a8abe9d34161126dc3134e6dd797e108ecf90fa9","path":"package-lock.json","start":{"line":739,"col":1,"offset":0},"end":{"line":739,"col":1,"offset":0},"extra":{"metavars":{},"message":"Affected versions of express are vulnerable to Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting').","metadata":{"confidence":"LOW","category":"security","cve":"CVE-2024-43796","cwe":["CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"],"ghsa":"GHSA-qw6h-vgh9-j6wx","owasp":["A03:2021 - Injection","A06:2021 - Vulnerable and Outdated Components","A07:2017 - Cross-Site Scripting (XSS)"],"publish-date":"2024-09-10T19:41:04Z","references":["https://github.com/advisories/GHSA-qw6h-vgh9-j6wx","https://nvd.nist.gov/vuln/detail/CVE-2024-43796"],"sca-fix-versions":[{"express":"5.0.0"},{"express":"4.20.0"}],"sca-kind":"legacy","sca-schema":20230302,"sca-severity":"LOW","sca-vuln-database-identifier":"CVE-2024-43796","technology":["js","ts"],"license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Cross-Site-Scripting (XSS)"],"semgrep.dev":{"rule":{"r_id":143185,"rv_id":969395,"rule_id":"r6UyqYD","version_id":"qkT4vDD","url":"https://semgrep.dev/orgs/-/supply-chain/advisories?q=ssc-parity-a8abe9d34161126dc3134e6dd797e108ecf90fa9","origin":"custom","rule_name":"ssc-parity-a8abe9d34161126dc3134e6dd797e108ecf90fa9"},"src":"unchanged"},"source":"https://semgrep.dev/orgs/-/supply-chain/advisories?q=ssc-parity-a8abe9d34161126dc3134e6dd797e108ecf90fa9","semgrep.url":"https://semgrep.dev/orgs/-/supply-chain/advisories?q=ssc-parity-a8abe9d34161126dc3134e6dd797e108ecf90fa9","dev.semgrep.actions":[]},"severity":"WARNING","fingerprint":"054bbf43b9075ceabb5fcc84a07697a9448778fb996ff8d41ea1f00c933cc70571fe6f529d63a896cba5d222224d46c2610b531b504d3684ec0f631fc4bd218d_0","lines":"    \"node_modules/express\": {","is_ignored":false,"sca_info":{"reachability_rule":false,"sca_finding_schema":20220913,"dependency_match":{"dependency_pattern":{"ecosystem":"npm","package":"express","semver_range":"<4.20.0"},"found_dependency":{"package":"express","version":"4.17.1","ecosystem":"npm","allowed_hashes":{"sha512":["98727d3bbf51aa5ba9851adcc365ff19387793db55bfc61ca326382a487858331460a45952ad21d68d30dabaebc41a8ced5a1e515aa06f6ef19443174e762de2"]},"resolved_url":"https://registry.npmjs.org/express/-/express-4.17.1.tgz","transitivity":"direct","manifest_path":"package.json","lockfile_path":"package-lock.json","line_number":739},"lockfile":"package-lock.json"},"reachable":false},"engine_kind":"OSS"}},{"check_id":"ssc-7507ae70-65b1-269c-e7df-4725af6d11ab","path":"package-lock.json","start":{"line":1424,"col":1,"offset":0},"end":{"line":1424,"col":1,"offset":0},"extra":{"metavars":{},"message":"Affected versions of path-to-regexp are vulnerable to Inefficient Regular Expression Complexity. The `path-to-regexp` package is vulnerable to Regular Expression Denial of Service (ReDoS) attacks, due to unlimited backtracking when using regex generated from a pattern with two parameters within a single path segment (e.g. `/:a-:b`).","metadata":{"confidence":"HIGH","category":"security","cve":"CVE-2024-52798","cwe":["CWE-1333: Inefficient Regular Expression Complexity"],"ghsa":"GHSA-rhx6-c78j-4q9w","owasp":["A06:2021 - Vulnerable and Outdated Components"],"publish-date":"2024-12-05T22:40:47Z","references":["https://github.com/advisories/GHSA-rhx6-c78j-4q9w","https://nvd.nist.gov/vuln/detail/CVE-2024-52798"],"sca-fix-versions":[{"path-to-regexp":"0.1.12"}],"sca-kind":"reachable","sca-schema":20230302,"sca-severity":"HIGH","sca-vuln-database-identifier":"CVE-2024-52798","technology":["js","ts"],"license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Denial-of-Service (DoS)"],"semgrep.dev":{"rule":{"r_id":155088,"rv_id":1129926,"rule_id":"0oULz5j","version_id":"gETOezY","url":"https://semgrep.dev/orgs/-/supply-chain/advisories?q=ssc-7507ae70-65b1-269c-e7df-4725af6d11ab","origin":"custom","rule_name":"ssc-7507ae70-65b1-269c-e7df-4725af6d11ab"},"src":"unchanged"},"source":"https://semgrep.dev/orgs/-/supply-chain/advisories?q=ssc-7507ae70-65b1-269c-e7df-4725af6d11ab","semgrep.url":"https://semgrep.dev/orgs/-/supply-chain/advisories?q=ssc-7507ae70-65b1-269c-e7df-4725af6d11ab","dev.semgrep.actions":[]},"severity":"ERROR","fingerprint":"69be448596b75a59e13b82aec5c750cd7f5a0255c09a594fce4ae97f8ce5fcec51be714f4e10c40bc68382742038c9070a7cf0f124d940956b6b8ee8c02b0812_0","lines":"    \"node_modules/path-to-regexp\": {","is_ignored":false,"sca_info":{"reachability_rule":true,"sca_finding_schema":20220913,"dependency_match":{"dependency_pattern":{"ecosystem":"npm","package":"path-to-regexp","semver_range":"<0.1.12"},"found_dependency":{"package":"path-to-regexp","version":"0.1.7","ecosystem":"npm","allowed_hashes":{"sha512":["e43164ba8aa5bf5b9840ac72f2898505e24f41c768134ecabf6b1f7ab0c2ac0ab5a21394f8c483b300c86e7c7760033ad2a20e9d86b9df00615d6d046cca27ad"]},"resolved_url":"https://registry.npmjs.org/path-to-regexp/-/path-to-regexp-0.1.7.tgz","transitivity":"transitive","manifest_path":"package.json","lockfile_path":"package-lock.json","line_number":1424},"lockfile":"package-lock.json"},"reachable":false},"engine_kind":"OSS"}},{"check_id":"ssc-b0e06ec4-81ff-4606-aa88-678079440888","path":"package-lock.json","start":{"line":1424,"col":1,"offset":0},"end":{"line":1424,"col":1,"offset":0},"extra":{"metavars":{},"message":"Affected versions of path-to-regexp are vulnerable to Inefficient Regular Expression Complexity. A bad regular expression is generated any time you have two parameters within a single segment, separated by something that is not a period (.). For example, `/:a-:b`. This can be mitigated by providing a custom regular expression for parameters after the first in a single segment (for example, changing `/:a-:b` to `/:a-:b([^-/]+)`).","metadata":{"confidence":"HIGH","category":"security","cve":"CVE-2024-45296","cwe":["CWE-1333: Inefficient Regular Expression Complexity"],"ghsa":"GHSA-9wv6-86v2-598j","owasp":["A06:2021 - Vulnerable and Outdated Components"],"publish-date":"2024-09-09T20:19:15Z","references":["https://github.com/advisories/GHSA-9wv6-86v2-598j","https://nvd.nist.gov/vuln/detail/CVE-2024-45296"],"sca-fix-versions":[{"path-to-regexp":"8.0.0"},{"path-to-regexp":"6.3.0"},{"path-to-regexp":"3.3.0"},{"path-to-regexp":"1.9.0"},{"path-to-regexp":"0.1.10"}],"sca-kind":"reachable","sca-schema":20230302,"sca-severity":"HIGH","sca-vuln-database-identifier":"CVE-2024-45296","technology":["js","ts"],"license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Denial-of-Service (DoS)"],"semgrep.dev":{"rule":{"r_id":142686,"rv_id":1129789,"rule_id":"OrUNzwY","version_id":"RGTRAYD","url":"https://semgrep.dev/orgs/-/supply-chain/advisories?q=ssc-b0e06ec4-81ff-4606-aa88-678079440888","origin":"custom","rule_name":"ssc-b0e06ec4-81ff-4606-aa88-678079440888"},"src":"unchanged"},"source":"https://semgrep.dev/orgs/-/supply-chain/advisories?q=ssc-b0e06ec4-81ff-4606-aa88-678079440888","semgrep.url":"https://semgrep.dev/orgs/-/supply-chain/advisories?q=ssc-b0e06ec4-81ff-4606-aa88-678079440888","dev.semgrep.actions":[]},"severity":"ERROR","fingerprint":"a1056b71e1861b1422ee8c1ae883beee51c02667bffc0f32284f043b2f9e57c8cc3e6577230baca532039c72bf1ba17829dd9b9fd10510ac75a9379bb054aad6_0","lines":"    \"node_modules/path-to-regexp\": {","is_ignored":false,"sca_info":{"reachability_rule":true,"sca_finding_schema":20220913,"dependency_match":{"dependency_pattern":{"ecosystem":"npm","package":"path-to-regexp","semver_range":"<0.1.10"},"found_dependency":{"package":"path-to-regexp","version":"0.1.7","ecosystem":"npm","allowed_hashes":{"sha512":["e43164ba8aa5bf5b9840ac72f2898505e24f41c768134ecabf6b1f7ab0c2ac0ab5a21394f8c483b300c86e7c7760033ad2a20e9d86b9df00615d6d046cca27ad"]},"resolved_url":"https://registry.npmjs.org/path-to-regexp/-/path-to-regexp-0.1.7.tgz","transitivity":"transitive","manifest_path":"package.json","lockfile_path":"package-lock.json","line_number":1424},"lockfile":"package-lock.json"},"reachable":false},"engine_kind":"OSS"}},{"check_id":"ssc-be9e222d-c253-46d1-9704-f0c4f50a107f","path":"package-lock.json","start":{"line":1469,"col":1,"offset":0},"end":{"line":1469,"col":1,"offset":0},"extra":{"metavars":{},"message":"Affected versions are vulnerable to Improperly Controlled Modification Of Object Prototype Attributes ('Prototype Pollution').","metadata":{"confidence":"HIGH","category":"security","cve":"CVE-2022-24999","cwe":["CWE-1321: Improperly Controlled Modification of Object Prototype Attributes ('Prototype Pollution')"],"ghsa":"GHSA-hrpp-h998-j3pp","owasp":["A06:2021 - Vulnerable and Outdated Components"],"publish-date":"2022-11-27T00:30:50Z","references":["https://github.com/advisories/GHSA-hrpp-h998-j3pp","https://nvd.nist.gov/vuln/detail/CVE-2022-24999"],"sca-fix-versions":[{"qs":"6.9.7"},{"qs":"6.8.3"},{"qs":"6.7.3"},{"qs":"6.6.1"},{"qs":"6.5.3"},{"qs":"6.4.1"},{"qs":"6.3.3"},{"qs":"6.2.4"},{"qs":"6.10.3"}],"sca-kind":"reachable","sca-schema":20230302,"sca-severity":"HIGH","sca-vuln-database-identifier":"CVE-2022-24999","technology":["js","ts"],"license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Other"],"semgrep.dev":{"rule":{"r_id":94683,"rv_id":951318,"rule_id":"5rUdOXX","version_id":"YDTvDwy","url":"https://semgrep.dev/orgs/-/supply-chain/advisories?q=ssc-be9e222d-c253-46d1-9704-f0c4f50a107f","origin":"custom","rule_name":"ssc-be9e222d-c253-46d1-9704-f0c4f50a107f"},"src":"unchanged"},"source":"https://semgrep.dev/orgs/-/supply-chain/advisories?q=ssc-be9e222d-c253-46d1-9704-f0c4f50a107f","semgrep.url":"https://semgrep.dev/orgs/-/supply-chain/advisories?q=ssc-be9e222d-c253-46d1-9704-f0c4f50a107f","dev.semgrep.actions":[]},"severity":"ERROR","fingerprint":"65f2408eb316dc23f0d4d703303a08fd8415835e11711703a6173650d530cdf7ba59a82a67ceb78882eff611d2a9cfa2e6449bff012a451bae55130c3c23e012_0","lines":"    \"node_modules/qs\": {","is_ignored":false,"sca_info":{"reachability_rule":true,"sca_finding_schema":20220913,"dependency_match":{"dependency_pattern":{"ecosystem":"npm","package":"qs","semver_range":">=6.7.0, <6.7.3"},"found_dependency":{"package":"qs","version":"6.7.0","ecosystem":"npm","allowed_hashes":{"sha512":["54274144d1535f57f213b35be85628511a3f48f7bad9009a032cc9bd48f045a22c73e35e3c112788796fc459a65f9ebe1d9a61206b55d177828ab06da43ad3c9"]},"resolved_url":"https://registry.npmjs.org/qs/-/qs-6.7.0.tgz","transitivity":"transitive","manifest_path":"package.json","lockfile_path":"package-lock.json","line_number":1469},"lockfile":"package-lock.json"},"reachable":false},"engine_kind":"OSS"}},{"check_id":"ssc-parity-e5df4b987af8c3a511cdef426e0150c53081100d","path":"package-lock.json","start":{"line":1612,"col":1,"offset":0},"end":{"line":1612,"col":1,"offset":0},"extra":{"metavars":{},"message":"Affected versions of send are vulnerable to Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting').","metadata":{"confidence":"LOW","category":"security","cve":"CVE-2024-43799","cwe":["CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"],"ghsa":"GHSA-m6fv-jmcg-4jfg","owasp":["A03:2021 - Injection","A06:2021 - Vulnerable and Outdated Components","A07:2017 - Cross-Site Scripting (XSS)"],"publish-date":"2024-09-10T19:42:41Z","references":["https://github.com/advisories/GHSA-m6fv-jmcg-4jfg","https://nvd.nist.gov/vuln/detail/CVE-2024-43799"],"sca-fix-versions":[{"send":"0.19.0"}],"sca-kind":"legacy","sca-schema":20230302,"sca-severity":"LOW","sca-vuln-database-identifier":"CVE-2024-43799","technology":["js","ts"],"license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Cross-Site-Scripting (XSS)"],"semgrep.dev":{"rule":{"r_id":143134,"rv_id":966652,"rule_id":"pKU1ork","version_id":"8KTKNy3","url":"https://semgrep.dev/orgs/-/supply-chain/advisories?q=ssc-parity-e5df4b987af8c3a511cdef426e0150c53081100d","origin":"custom","rule_name":"ssc-parity-e5df4b987af8c3a511cdef426e0150c53081100d"},"src":"unchanged"},"source":"https://semgrep.dev/orgs/-/supply-chain/advisories?q=ssc-parity-e5df4b987af8c3a511cdef426e0150c53081100d","semgrep.url":"https://semgrep.dev/orgs/-/supply-chain/advisories?q=ssc-parity-e5df4b987af8c3a511cdef426e0150c53081100d","dev.semgrep.actions":[]},"severity":"WARNING","fingerprint":"216b95e974302818958142330198b74c3959fdae3e90b795a905f4d197c00c4854d8e69355092dff32b85a8cc1e5053d49bd34c9882f89a19fcc9fa9c2063d4a_0","lines":"    \"node_modules/send\": {","is_ignored":false,"sca_info":{"reachability_rule":false,"sca_finding_schema":20220913,"dependency_match":{"dependency_pattern":{"ecosystem":"npm","package":"send","semver_range":"<0.19.0"},"found_dependency":{"package":"send","version":"0.17.1","ecosystem":"npm","allowed_hashes":{"sha512":["06c54ab2219c40c1704fc531ca9a1b50acafee2ac23511e4d53d06ebcd2f93cf327fa2c107219c649393242ad33f6c5537ac88f978cf25c36e1375787d3f6c02"]},"resolved_url":"https://registry.npmjs.org/send/-/send-0.17.1.tgz","transitivity":"transitive","manifest_path":"package.json","lockfile_path":"package-lock.json","line_number":1612},"lockfile":"package-lock.json"},"reachable":false},"engine_kind":"OSS"}},{"check_id":"ssc-parity-c1f65c198e6079c81f6f30af16bec6fbc6c4c44d","path":"package-lock.json","start":{"line":1642,"col":1,"offset":0},"end":{"line":1642,"col":1,"offset":0},"extra":{"metavars":{},"message":"Affected versions of serve-static are vulnerable to Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting').","metadata":{"confidence":"LOW","category":"security","cve":"CVE-2024-43800","cwe":["CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"],"ghsa":"GHSA-cm22-4g7w-348p","owasp":["A03:2021 - Injection","A06:2021 - Vulnerable and Outdated Components","A07:2017 - Cross-Site Scripting (XSS)"],"publish-date":"2024-09-10T19:42:33Z","references":["https://github.com/advisories/GHSA-cm22-4g7w-348p","https://nvd.nist.gov/vuln/detail/CVE-2024-43800"],"sca-fix-versions":[{"serve-static":"2.1.0"},{"serve-static":"1.16.0"}],"sca-kind":"legacy","sca-schema":20230302,"sca-severity":"LOW","sca-vuln-database-identifier":"CVE-2024-43800","technology":["js","ts"],"license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Cross-Site-Scripting (XSS)"],"semgrep.dev":{"rule":{"r_id":143060,"rv_id":961873,"rule_id":"PeUJvge","version_id":"DkTNnbr","url":"https://semgrep.dev/orgs/-/supply-chain/advisories?q=ssc-parity-c1f65c198e6079c81f6f30af16bec6fbc6c4c44d","origin":"custom","rule_name":"ssc-parity-c1f65c198e6079c81f6f30af16bec6fbc6c4c44d"},"src":"unchanged"},"source":"https://semgrep.dev/orgs/-/supply-chain/advisories?q=ssc-parity-c1f65c198e6079c81f6f30af16bec6fbc6c4c44d","semgrep.url":"https://semgrep.dev/orgs/-/supply-chain/advisories?q=ssc-parity-c1f65c198e6079c81f6f30af16bec6fbc6c4c44d","dev.semgrep.actions":[]},"severity":"WARNING","fingerprint":"0a7601314a41662425274f80b802983f6681fd4d9f089d41aa554a12fd6412438478d8ced3f5a75521e9a6c8b36b6893b67729b36cdb6f75104b70ec640b50f1_0","lines":"    \"node_modules/serve-static\": {","is_ignored":false,"sca_info":{"reachability_rule":false,"sca_finding_schema":20220913,"dependency_match":{"dependency_pattern":{"ecosystem":"npm","package":"serve-static","semver_range":"<1.16.0"},"found_dependency":{"package":"serve-static","version":"1.14.1","ecosystem":"npm","allowed_hashes":{"sha512":["24caef530139e1e98261695323e846ac6bf923c744c26728ff4d04be4cc822c47b32aac7a276c3f693b630e7c59e9167b65ede72966cfb7996f976d066ef500a"]},"resolved_url":"https://registry.npmjs.org/serve-static/-/serve-static-1.14.1.tgz","transitivity":"transitive","manifest_path":"package.json","lockfile_path":"package-lock.json","line_number":1642},"lockfile":"package-lock.json"},"reachable":false},"engine_kind":"OSS"}}],"errors":[],"paths":{"scanned":[".dockerignore",".env",".gitignore",".gitleaks.toml",".semgrepignore","Dockerfile","Jenkinsfile","Jenkinsfile-Ref","app.js","lab-setup/Arch.png","lab-setup/Dockerfile","lab-setup/README.md","package-lock.json","package.json"]},"time":{"rules":[],"rules_parse_time":33.850250005722046,"profiling_times":{"config_time":341.052472114563,"core_time":45.845919370651245,"ignores_time":0.11753225326538086,"total_time":387.36146426200867},"parsing_time":{"total_time":0.0,"per_file_time":{"mean":0.0,"std_dev":0.0},"very_slow_stats":{"time_ratio":0.0,"count_ratio":0.0},"very_slow_files":[]},"scanning_time":{"total_time":0.0,"per_file_time":{"mean":0.0,"std_dev":0.0},"very_slow_stats":{"time_ratio":0.0,"count_ratio":0.0},"very_slow_files":[]},"matching_time":{"total_time":0.0,"per_file_and_rule_time":{"mean":0.0,"std_dev":0.0},"very_slow_stats":{"time_ratio":0.0,"count_ratio":0.0},"very_slow_rules_on_files":[]},"tainting_time":{"total_time":0.0,"per_def_and_rule_time":{"mean":0.0,"std_dev":0.0},"very_slow_stats":{"time_ratio":0.0,"count_ratio":0.0},"very_slow_rules_on_defs":[]},"fixpoint_timeouts":[],"prefiltering":{"project_level_time":0.0,"file_level_time":0.0,"rules_with_project_prefilters_ratio":0.0,"rules_with_file_prefilters_ratio":0.0,"rules_selected_ratio":0.0,"rules_matched_ratio":0.0},"targets":[],"total_bytes":0,"max_memory_bytes":9277989248},"engine_requested":"PRO","interfile_languages_used":[],"skipped_rules":[],"subprojects":[{"dependency_sources":["package-lock.json"],"resolved":true,"resolved_stats":{"resolution_method":"LockfileParsing","dependency_count":162,"ecosystem":"npm"}}]}